function addExtraButton(){document.getElementsByClassName("sc-button-group-medium")[0];if($("ytd-app>#content>#page-manager>ytd-watch>#top>#container>#main>#info.ytd-watch>#info-contents>ytd-video-primary-info-renderer>#container>#info.ytd-video-primary-info-renderer>#menu-container>#menu>ytd-menu-renderer>#top-level-buttons").length>0){var t=document.getElementById("motorbot-button");if(void 0!==t&&null!=t);else{var o=document.createElement("div");o.className="style-scope ytd-menu-renderer style-default",o.style.marginLeft="10px",o.innerHTML='<div id="motorbot-button"><img style="height: 22px;" src='+chrome.extension.getURL("icon.png")+'></div><style type="text/css">#motorbot-button{opacity: 0.8; cursor: pointer; padding: 8px 12px;} #motorbot-button:hover{opacity: 1;} #motorbot-button:active{opacity: 0.6;} .loader{margin-left: calc(50% - 5px); margin-top: 15px; width: 11px; height: 11px; border: 2px solid transparent; border-top-color: rgba(22, 122, 198, 1.00); border-left-color: rgba(22, 122, 198, 1.00); border-radius: 50%; box-sizing: border-box; display: inline-block; vertical-align: middle; animation: spinner 0.5s infinite linear} @keyframes spinner{0%{transform: rotate(0deg)} 100%{transform: rotate(360deg);}} #motorbotDropDown{position: absolute; background: #232323; box-shadow: 0 0 25px #000; min-height: 40px; overflow: hidden;}</style>',dropDownMenu=$("#motorbotDropDown"),$("ytd-app>#content>#page-manager>ytd-watch>#top>#container>#main>#info.ytd-watch>#info-contents>ytd-video-primary-info-renderer>#container>#info.ytd-video-primary-info-renderer>#menu-container>#menu>ytd-menu-renderer>#top-level-buttons").append(o),$("body").append("<div style='min-width: 260px; width: 320px; left: "+($("#motorbot-button").offset().left-20)+"px; top: "+($("#motorbot-button").offset().top+40)+"px; z-index: 300; display: none;' id='motorbotDropDown'><ul id='motorbot-user-playlists'></ul></div>")}document.getElementById("motorbot-button").addEventListener("click",function(t){console.info("Motorbot-Button"),"none"!=$("#motorbotDropDown").css("display")||$("#motorbot-button").attr("disabled")?$("#motorbotDropDown").css("display","none"):chrome.storage.sync.get("userInfo",function(t){if(null==t.userInfo)$("#motorbot-button").attr("disabled","true").css("opacity","1").html("<span class=\"yt-uix-button-content\" style='color: rgba(255, 0, 0, 1.00); vertical-align: middle; font-family: Roboto, Arial, sans-serif; font-size: 13px; font-weight: 500; letter-spacing: 0.007px; line-height: 21px;'>AUTHENTICATION ERROR</span>"),console.error("[Motorbot] Error Occurred Sending Video to motorbot: You're not authenticated :(");else{$("#motorbotDropDown").css("top",$("#motorbot-button").offset().top+40+"px").css("left",$("#motorbot-button").offset().left-10+"px").css("display","block"),$("#motorbotDropDown").html("<div class='loader'></div>");getParameterByName("v",window.location.href);$.ajax({url:"https://motorbot.io/api/user/playlists?limit=50&filter=id,name,creator&api_key=caf07b8b-366e-44ab-9bda-152a42g8d1ef",dataType:"json",beforeSend:function(o){o.setRequestHeader("Authorization","Bearer "+t.userInfo.token)},success:function(o){$("#motorbotDropDown").html("<div id=\"header\" class=\"style-scope ytd-add-to-playlist-renderer\">Add to...</div><div class='motorbot-user-scrollview'><ul id='motorbot-user-playlists' class='yt-uix-kbd-nav yt-uix-kbd-nav-list'></ul></div></div><style type='text/css'>#header.ytd-add-to-playlist-renderer {\n    color: var(--yt-primary-text-color);\n    padding: 16px 24px;\n    border-bottom: 1px solid var(--yt-border-color);\n    font-size: 1.6rem;\n    font-weight: 400;\n    line-height: 2rem;\n} .motorbot-user-scrollview{overflow-y: auto; overflow-x: hidden; width: 100%; max-height: 300px;} #motorbot-user-playlists{list-style: none; margin: 15px; margin-top: 10px; margin-bottom: 10px; padding: 0;} #motorbot-user-playlists li{font-size: 1.4rem; font-weight: 400; color: #fff; line-height: 40px; width: calc(100% - 20px); padding-left: 10px; padding-right: 10px; font-family: 'Roboto', 'Noto', sans-serif; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; cursor: pointer; -webkit-font-smoothing: antialiased; border-radius: 4px;} #motorbot-user-playlists li:hover{background: rgba(200,200,200,0.1);}</style>"),o.items&&($.each(o.items,function(o,e){e.creator==t.userInfo.id.toString()&&$("#motorbot-user-playlists").append("<li class='motorbot-playlist-item' data-playlistId='"+e.id+"'>"+e.name+"</li>")}),$(".motorbot-playlist-item").each(function(t){$(this).click(function(t){var o=$(this).attr("data-playlistId");chrome.storage.sync.get("userInfo",function(t){if(null==t.userInfo)$("#motorbot-button").attr("disabled","true").css("opacity","1").html("<span class=\"yt-uix-button-content\" style='color: rgba(255, 0, 0, 1.00); vertical-align: middle; font-family: Roboto, Arial, sans-serif; font-size: 13px; font-weight: 500; letter-spacing: 0.007px; line-height: 21px;'>AUTHENTICATION ERROR</span>"),console.error("[Motorbot] Error Occurred Sending Video to motorbot: You're not authenticated :(");else{var e=getParameterByName("v",window.location.href);console.info("[Motorbot] "+t.userInfo.id+" Adding video "+e+" to playlist "+o),$.ajax({url:"https://motorbot.io/api/playlist/"+o+"/song?api_key=caf07b8b-366e-44ab-9bda-152a42g8d1ef",type:"PUT",dataType:"json",processData:!1,contentType:"application/json",data:JSON.stringify({source:"ytb",video_id:e}),beforeSend:function(o){o.setRequestHeader("Authorization","Bearer "+t.userInfo.token)},success:function(t){t.added&&$("#motorbot-button").attr("disabled","true").css("opacity","1").html("<span class=\"yt-uix-button-content\" style='color: rgba(0, 200, 83, 1.00); vertical-align: middle; font-family: Roboto, Arial, sans-serif; font-size: 13px; font-weight: 500; letter-spacing: 0.007px; line-height: 21px;'>ADDED</span>"),$("#motorbotDropDown").css("display","none")},error:function(t){$("#motorbot-button").attr("disabled","true").css("opacity","1").html("<span class=\"yt-uix-button-content\" style='color: rgba(255, 0, 0, 1.00); vertical-align: middle; font-family: Roboto, Arial, sans-serif; font-size: 13px; font-weight: 500; letter-spacing: 0.007px; line-height: 21px;'>ERROR</span>"),console.error("Error Occurred Sending Video to motorbot: "+t)}})}})})}))},error:function(t){$("#motorbot-button").attr("disabled","true").css("opacity","1").html("<span class=\"yt-uix-button-content\" style='color: rgba(255, 0, 0, 1.00); vertical-align: middle; font-family: Roboto, Arial, sans-serif; font-size: 13px; font-weight: 500; letter-spacing: 0.007px; line-height: 21px;'>ERROR</span>"),console.error("[Motorbot] Error Occurred Getting Playlists: "+t),$("#motorbotDropDown").css("display","none")}})}})})}}function getParameterByName(t,o){o||(o=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var e=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(o);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null}chrome.runtime.onMessage.addListener(function(t,o,e){"youtube_request"==t.type&&(null==document.getElementById("motorbot-button")&&addExtraButton())});